const Jwt = require('../src/jwt.js');

async function go() {
  // verify it now
  const verifyParams = {
    alg: 'PS256',
    signature: 'eyJhbGciOiJQUzI1NiIsImtpZCI6IkJRTk0zU3NTRXh0TnVXeEo4UHV2cnc5V3ZxNUJObHhoY3FHUExrNUozdUU9IiwidHlwIjoiSldUIn0.eyJpc3MiOiJPcGVuQmFua2luZyBMdGQiLCJpYXQiOjE1NzI0MzU3NDMsImp0aSI6IjE3OTQxOWEyYjkwYjQyMzEiLCJzb2Z0d2FyZV9lbnZpcm9ubWVudCI6InByb2R1Y3Rpb24iLCJzb2Z0d2FyZV9tb2RlIjoiTGl2ZSIsInNvZnR3YXJlX2lkIjoiWWQzejZWdzlnOTJaZEtzcnhqR2ozdiIsInNvZnR3YXJlX2NsaWVudF9pZCI6IllkM3o2Vnc5ZzkyWmRLc3J4akdqM3YiLCJzb2Z0d2FyZV9jbGllbnRfbmFtZSI6Ik96b25lIFRQUCBUZXN0Iiwic29mdHdhcmVfY2xpZW50X2Rlc2NyaXB0aW9uIjoiVGlkZSBQbGF0Zm9ybSBMdGQgT3BlbiBCYW5raW5nIEFQSSIsInNvZnR3YXJlX3ZlcnNpb24iOjMuMSwic29mdHdhcmVfY2xpZW50X3VyaSI6Imh0dHBzOi8vcnMub3BlbmJhbmtpbmcuYXBpLnN0YWdpbmcudGlkZS5jby8iLCJzb2Z0d2FyZV9yZWRpcmVjdF91cmlzIjpbImh0dHBzOi8vYXBwLnRpZGUuY28vbGlua3Mvb3BlbmJhbmtpbmcvYXV0aG9yaXNlIl0sInNvZnR3YXJlX3JvbGVzIjpbIkFTUFNQIl0sIm9yZ2FuaXNhdGlvbl9jb21wZXRlbnRfYXV0aG9yaXR5X2NsYWltcyI6eyJhdXRob3JpdHlfaWQiOiJGQ0FHQlIiLCJyZWdpc3RyYXRpb25faWQiOiI5MDA4NDMiLCJzdGF0dXMiOiJBY3RpdmUiLCJhdXRob3Jpc2F0aW9ucyI6W3sibWVtYmVyX3N0YXRlIjoiR0IiLCJyb2xlcyI6WyJBU1BTUCJdfV19LCJzb2Z0d2FyZV9sb2dvX3VyaSI6Imh0dHBzOi8vd3d3LnRpZGUuY28vYXNzZXRzL2ltZy90aWRlLWxvZ28tYmx1ZS5zdmciLCJvcmdfc3RhdHVzIjoiQWN0aXZlIiwib3JnX2lkIjoiMDAxNTgwMDAwMVpFYzNoQUFEIiwib3JnX25hbWUiOiJUSURFIFBMQVRGT1JNIExURCIsIm9yZ19jb250YWN0cyI6W10sIm9yZ19qd2tzX2VuZHBvaW50IjoiaHR0cHM6Ly9rZXlzdG9yZS5vcGVuYmFua2luZy5vcmcudWsvMDAxNTgwMDAwMVpFYzNoQUFELzAwMTU4MDAwMDFaRWMzaEFBRC5qd2tzIiwib3JnX2p3a3NfcmV2b2tlZF9lbmRwb2ludCI6Imh0dHBzOi8va2V5c3RvcmUub3BlbmJhbmtpbmcub3JnLnVrLzAwMTU4MDAwMDFaRWMzaEFBRC9yZXZva2VkLzAwMTU4MDAwMDFaRWMzaEFBRC5qd2tzIiwic29mdHdhcmVfandrc19lbmRwb2ludCI6Imh0dHBzOi8va2V5c3RvcmUub3BlbmJhbmtpbmcub3JnLnVrLzAwMTU4MDAwMDFaRWMzaEFBRC9ZZDN6NlZ3OWc5MlpkS3NyeGpHajN2Lmp3a3MiLCJzb2Z0d2FyZV9qd2tzX3Jldm9rZWRfZW5kcG9pbnQiOiJodHRwczovL2tleXN0b3JlLm9wZW5iYW5raW5nLm9yZy51ay8wMDE1ODAwMDAxWkVjM2hBQUQvcmV2b2tlZC9ZZDN6NlZ3OWc5MlpkS3NyeGpHajN2Lmp3a3MiLCJzb2Z0d2FyZV9wb2xpY3lfdXJpIjoiaHR0cHM6Ly9jb21tdW5pdHkudGlkZS5jby90L3N1cHBvcnQtdGVybXMtY29uZGl0aW9ucy8zNjUiLCJzb2Z0d2FyZV90b3NfdXJpIjoiaHR0cHM6Ly9zdGF0aWMudGlkZS5jby9NZW1iZXIlMjB0ZXJtcy5wZGYiLCJzb2Z0d2FyZV9vbl9iZWhhbGZfb2Zfb3JnIjpudWxsfQ.KxTtfYT3_Xv6BVYvtsYTeIbQpFv-mZDpPmZDiNAApsUY0YEaMmNoY4c-oBBV5WC16PgKvt8Eas5Kk7-FBlyfCJkRzSECBfMlqud4j9NQVwf0dEcKW1o90bNb6X3GxBBkmVypcgoSZ10biXDz5S1uPGXo33PKpd-Rl3r_cfZFoC-3pQuQyUbMdCRuZTf8gPPkcl7Ls7ZSBtiDu1KBxF1HMf6BB3DJW8DXGOrNSUbA6x-VHOxFL2I-vxKLeX9fEXnJqqLvZOnm4G7e2LOjUFA4TPkwD2VFsMJ5wWJNsBqJXWb9l01iioGdvey9fiTXFMeWjxYoJ3oswXO7sGetAmC8LQ',
    jwks: {
      "keys": [
          {
              "e": "AQAB",
              "kid": "BQNM3SsSExtNuWxJ8Puvrw9Wvq5BNlxhcqGPLk5J3uE=",
              "kty": "RSA",
              "n": "3cvOeY5XDzJF7ZY_eFEQ1fGnU-TaDH-V9F1oC6UaHS7Px_u7OhjDgdPbAGddda5ht5LKmQoVPIaNtYDlK_WARRhBrodhx86gD9ldpqW2cHV-7ALZEY-EW10NeGgAA2SFiiwu585iQz8nJpJbbrSvVvNyMtU5tfJ2EOoqEzpBWJhdZpGaayN03d7Vg2z3-3Zy5zdIBf3Zq-O2LM8QutRvC0JcJLh4_OCAymuClnwsEKhpkokjzLAaXUHYz1KLoUmzZFkwYuSGyf690xs3RQrnjM0GayAkyTZ4tznDG4eLu9iJFEyx9rlRBtJwqqi4m9b4__WC7ITEaLqQoFpo-mDKUQ",
              "x5u": "https://keystore.openbanking.org.uk/keystore/openbanking.pem",
              "x5c": [
                  "MIIFkDCCBHigAwIBAgIEWf9KrTANBgkqhkiG9w0BAQsFADBEMQswCQYDVQQGEwJHQjEUMBIGA1UEChMLT3BlbkJhbmtpbmcxHzAdBgNVBAMTFk9wZW5CYW5raW5nIElzc3VpbmcgQ0EwHhcNMTgxMjEyMTA0MzQzWhcNMjAwMTEyMTExMzQzWjBWMQswCQYDVQQGEwJHQjEUMBIGA1UEChMLT3BlbkJhbmtpbmcxHzAdBgNVBAsTFk9wZW4gQmFua2luZyBEaXJlY3RvcnkxEDAOBgNVBAMTB3NpZ25pbmcwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDdy855jlcPMkXtlj94URDV8adT5NoMf5X0XWgLpRodLs/H+7s6GMOB09sAZ111rmG3ksqZChU8ho21gOUr9YBFGEGuh2HHzqAP2V2mpbZwdX7sAtkRj4RbXQ14aAADZIWKLC7nzmJDPycmkltutK9W83Iy1Tm18nYQ6ioTOkFYmF1mkZprI3Td3tWDbPf7dnLnN0gF/dmr47YszxC61G8LQlwkuHj84IDKa4KWfCwQqGmSiSPMsBpdQdjPUouhSbNkWTBi5IbJ/r3TGzdFCueMzQZrICTJNni3OcMbh4u72IkUTLH2uVEG0nCqqLib1vj/9YLshMRoupCgWmj6YMpRAgMBAAGjggJ2MIICcjAOBgNVHQ8BAf8EBAMCBsAwFQYDVR0lBA4wDAYKKwYBBAGCNwoDDDCCAVIGA1UdIASCAUkwggFFMIIBQQYLKwYBBAGodYEGAQEwggEwMDUGCCsGAQUFBwIBFilodHRwOi8vb2IudHJ1c3Rpcy5jb20vcHJvZHVjdGlvbi9wb2xpY2llczCB9gYIKwYBBQUHAgIwgekMgeZUaGlzIENlcnRpZmljYXRlIGlzIHNvbGVseSBmb3IgdXNlIHdpdGggT3BlbiBCYW5raW5nIExpbWl0ZWQgYW5kIGFzc29jaWF0ZWQgT3BlbiBCYW5raW5nIFNlcnZpY2VzLiBJdHMgcmVjZWlwdCwgcG9zc2Vzc2lvbiBvciB1c2UgY29uc3RpdHV0ZXMgYWNjZXB0YW5jZSBvZiB0aGUgT3BlbiBCYW5raW5nIExpbWl0ZWQgQ2VydGlmaWNhdGUgUG9saWN5IGFuZCByZWxhdGVkIGRvY3VtZW50cyB0aGVyZWluLjByBggrBgEFBQcBAQRmMGQwJgYIKwYBBQUHMAGGGmh0dHA6Ly9vYi50cnVzdGlzLmNvbS9vY3NwMDoGCCsGAQUFBzAChi5odHRwOi8vb2IudHJ1c3Rpcy5jb20vcHJvZHVjdGlvbi9pc3N1aW5nY2EuY3J0MD8GA1UdHwQ4MDYwNKAyoDCGLmh0dHA6Ly9vYi50cnVzdGlzLmNvbS9wcm9kdWN0aW9uL2lzc3VpbmdjYS5jcmwwHwYDVR0jBBgwFoAUn0m/TjanrMMPK8hH9B8pG8B5CwUwHQYDVR0OBBYEFOPiDInGOOCbDXeWMLA+wLTWtYtzMA0GCSqGSIb3DQEBCwUAA4IBAQCyzOXCB36LE//9XOBu0QrKbolqUSxSSlxJwbmf7quEp2esxm+UZqc9b6ZOrfdrCe282fiiJMKk5hcd6t91YNH3QqC3dr4aObzPIN64+KP6PCYwlbJ2K3XcfwyetcpnVJkF4WmPkzU4nvgjMoEk4UnOKK2pJb9QxgAggOQtIK93oupSzv2CiQXQr1WbvYZLLV4/1FdkqtcZp4ik5oJjff7f9cTtTtY1W5ECkzUyKXa6q1BsRzPbcddkE3Xu5KBQGDgThwLpvqlS1+2C5Q3qKQsdHqlRQXu7ye0NxthS204sh4E2Wz+r5Xn61uJfY2xUBNsnEXSYT0HnCVLAOkz7yeIL-----END CERTIFICATE-----",
                  "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-----END CERTIFICATE-----",
                  "MIIFQjCCAyqgAwIBAgIEWgGaAzANBgkqhkiG9w0BAQsFADBBMQswCQYDVQQGEwJHQjEUMBIGA1UEChMLT3BlbkJhbmtpbmcxHDAaBgNVBAMTE09wZW5CYW5raW5nIFJvb3QgQ0EwHhcNMTcxMTA3MTEwOTM2WhcNMzcxMTA3MTEzOTM2WjBBMQswCQYDVQQGEwJHQjEUMBIGA1UEChMLT3BlbkJhbmtpbmcxHDAaBgNVBAMTE09wZW5CYW5raW5nIFJvb3QgQ0EwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDvJkaqdaIUNgTnXcJ3lKLyjhTJSsNtYzmN7fvpn8oseBQXQDKzJAvLXhfUEVeuUu3Zv/TG+ab/pSFdtiibh5PLIbB8nQDORl/fAA68wIjImsa2feUcq91Y+dKdKN8iW6zop8aDL8qwEggAV/u3TRfOhF8LSKHOEZ/7/YRTuqinAxDkeHYh7G+uSReyP4NvehhDkSuhK44zbyEddOvvcAOrkYr9TtBj6iZ5OMVZGO9tY9gRkbiQOt1FozyuYB7XT0QzokIfBWE0CZ1ypdu2bttDC7CuVhw9QSnyFHIG6HtQi2zKZH9OceMPJiG9RAdBUDZ3qqLFEVSvw1Dgfu/iatPEgYTbRDA85EHeGCcTMCTGra0eoITekrq//CRW1e73lK40SFzmMK/lKD3B2qWz/TxMvEH186s5REKPC6ptiQ4TxIp8Ls4gn2UHGwbS7i9ihryr0/ww9ILzy3gkuahf1t6PaNwmU02dovfLG5LJrMnvn8P6SdPwgbt3TtMKPBTxawQK+4N7wcY3slvh6bj9XLdyYKkqAk5QDiGoyZypZ6iH6P40gxJgJquF3kgYTSWunWkylDC6QgUU5U+x43SorH3qBB/fN5+daI8PQo80gbvonnWDAelxMkNUTkt/469CBpOd0Ok5uhl6g1cb9Tl1i3IR1c3Daa1hHK2eoKfsOMjwVwIDAQABo0IwQDAOBgNVHQ8BAf8EBAMCAQYwDwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUKnp9q41DYWT2XgHagTSVGFM8ny4wDQYJKoZIhvcNAQELBQADggIBAGX85+GSIXLJhZ6FwXZgrm+jKvdzxWP3qkwEhNmxfA3Cl4oVzINkn8fQfz3LN9zwTqRusxXfdpSdxfMesB480sDUDy88VAIdNi5A1DFFL02qZJxOH5cBRN+VVRPfRLSXK56LlbItM38GdhRVhd0FVnpG9+tqkmseF63rDCP30BOidUEH1Ong+0Bt8vZOs/OcPyGswsQJS3/7I1QFPxm/0F7wwBxdZwODcz4TAmw9EpePgNvI7ayhM7V/krMJeyG1bQ1sXu7LWdQIEEavrnV0fGgWPbG9L1QzhIxO5PzUKsA09W3wweRVQJxcYRWw3L1orwrvKZktvsKq1K7PEsIzHd3N/L+gGNDdYCZgeL+uv4aIoArPvJa06bVBSiunmkN4LuSRv0pVQPXkNzNkeTgJuCqE8DQavkjDY6OvhTjL54LGT8cv8wrgL9ZZWiol+LYABiF3ffdS7uXNAMEmHTAniBsw6t4VmoT6sjDD7Y4QLG7mJ53MIFbBb/+Y3IJQj474Yl9bOk3lbEJ8fSj1DtuRrygxDjUFZ2IqbuliLN86nN9SMIr+WZBAIG3bT3I8EkAvVPPHiWXjZZV/oBQq3C4fZT7ELu1Y2Z4h3Z/OW3/8OHbqKHnXS9MsOvJ1cVHHb/dRAeg2iKLbVikYKQM5mShYIJ0zIxKS7I/UKU5fYtfkskMi"
              ],
              "use": "sig",
              "x5t": "4M5W-SICRMkllKJsmUq2pCOQ82g=",
              "x5t#S256": "BQNM3SsSExtNuWxJ8Puvrw9Wvq5BNlxhcqGPLk5J3uE="
          }
      ]
    }
  };

  const verified = await Jwt.verify(verifyParams);
  console.log(`Verified: ${verified}`);

  return Jwt.decode(verifyParams.signature);
}

go()
  .then(out => console.log(out))
  .catch(err => console.log(err));
